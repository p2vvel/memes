{% extends 'base.html' %}


{% block content %}
<h1>Main site</h1>

{% if user.is_authenticated %}
<form method="POST" action="{% url "meme_add" %}" enctype="multipart/form-data">
    {% csrf_token %}
    {{form.as_p}}
    <input type="submit" value="Add meme">
</form>
{% endif %}


{% for m in memes %}
    <div class="meme">
        <h3><a href={% url "meme_view" pk=m.pk %}>
        {{m.title}}
        </a>
        </h3>
        <img src={{m.normal_image.url}} alt="Meme img">
        <p>{{m.description}}</p>
    </div>
{% comment %} TODO: Add 'hidden' and 'accepted' switch for superuser {% endcomment %}
{% endfor %}


{% if page_obj.paginator and page_obj.paginator.num_pages > 1 %}
    <div class="row">
    <div class="col d-flex justify-content-center my-3">
        <nav aria-label="Page navigation example">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href={% url "fresh_memes" page=1 %}>First</a></li>
            
            {% for i in page_obj.paginator.page_range %}
                {% if i == page_obj.number  %}
                    <li class="page-item active"><a class="page-link" href={% url "fresh_memes" page=i %}>{{i}}</a></li>
                {% elif i >= page_obj.number|add:-3 and i <= page_obj.number|add:3%}
                    <li class="page-item"><a class="page-link" href={% url "fresh_memes" page=i %}>{{i}}</a></li>
                {% endif %}
            {% endfor %}
            <li class="page-item"><a class="page-link" href={% url "fresh_memes" page=page_obj.paginator.num_pages %}>Last</a></li>
        </ul>
        </nav>
    </div>
    </div> 
{% endif %}



{% endblock content %}